<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Empleados</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</head>
<body>

<div class="container my-4">

  <!-- titulo -->
  <h1 class="h4 mb-3">Reporte de empleados</h1>

  <!-- filtros -->
  <form method="post" class="row g-2 mb-3" th:action="@{/ui/employees/buscar}">
    <div class="col-12 col-md-2">
      <label class="form-label">Emp No</label>
      <input type="number" name="empNo" class="form-control" th:value="${empNo}">
    </div>

    <div class="col-12 col-md-3">
      <label class="form-label">Nombre</label>
      <input type="text" name="firstName" class="form-control" th:value="${firstName}">
    </div>

    <div class="col-12 col-md-3">
      <label class="form-label">Apellido</label>
      <input type="text" name="lastName" class="form-control" th:value="${lastName}">
    </div>

    <div class="col-12 col-md-2">
      <label class="form-label">Género</label>
      <select name="gender" class="form-select">
        <option value="" th:selected="${gender == null || gender == ''}">Todos</option>
        <option value="M" th:selected="${gender == 'M'}">M</option>
        <option value="F" th:selected="${gender == 'F'}">F</option>
      </select>
    </div>


    <div class="col-12 col-md-2">
      <label class="form-label">Depto</label>
      <input type="text" name="deptNo" class="form-control" placeholder="d001" th:value="${deptNo}">
    </div>

    <div class="col-12 col-md-3">
      <label class="form-label">Hire date</label>
      <input type="date" name="hireDate" class="form-control" th:value="${hireDate}">
    </div>

    <div class="col-12 col-md-3">
      <label class="form-label">Birth date</label>
      <input type="date" name="birthDate" class="form-control" th:value="${birthDate}">
    </div>

    <div class="col-12 col-md-3">
      <label class="form-label">From date</label>
      <input type="date" name="fromDate" class="form-control" th:value="${fromDate}">
    </div>

    <div class="col-12 col-md-3">
      <label class="form-label">To date</label>
      <input type="date" name="toDate" class="form-control" th:value="${toDate}">
    </div>

    <!-- paginación -->
    <div class="col-6 col-md-2">
      <label class="form-label">Página</label>
      <input type="number" name="page" class="form-control" min="0" th:value="${page}">
    </div>

    <div class="col-6 col-md-2">
      <label class="form-label">Tamaño</label>
      <input type="number" name="size" class="form-control" min="1" max="200" th:value="${size}">
    </div>

    <!-- botones -->
    <div class="col-12 d-flex gap-2 mt-2">
      <button type="submit" class="btn btn-primary btn-sm">Buscar</button>
      <a th:href="@{/ui/employees}" class="btn btn-outline-secondary btn-sm">Limpiar</a>
    </div>
  </form>

  <!-- mensaje error -->
  <div class="alert alert-danger py-1 mb-3" th:if="${error}" th:text="${error}"></div>

  <!-- tabla de resultados -->
  <div th:if="${results != null}">
    <div class="d-flex justify-content-between align-items-center mb-2">
      <div class="text-muted small">
        Total: <span th:text="${results.totalElements}"></span> |
        Página: <span th:text="${results.number}"></span> / <span th:text="${results.totalPages - 1}"></span>
      </div>

      <div class="d-flex gap-2">
        <form method="post" th:action="@{/ui/employees/buscar}" class="m-0">
          <input type="hidden" name="empNo" th:value="${empNo}">
          <input type="hidden" name="birthDate" th:value="${birthDate}">
          <input type="hidden" name="firstName" th:value="${firstName}">
          <input type="hidden" name="lastName" th:value="${lastName}">
          <input type="hidden" name="gender" th:value="${gender}">
          <input type="hidden" name="hireDate" th:value="${hireDate}">
          <input type="hidden" name="deptNo" th:value="${deptNo}">
          <input type="hidden" name="fromDate" th:value="${fromDate}">
          <input type="hidden" name="toDate" th:value="${toDate}">
          <input type="hidden" name="size" th:value="${size}">
          <input type="hidden" name="page" th:value="${(results.number > 0) ? results.number - 1 : 0}">
          <button class="btn btn-outline-primary btn-sm" type="submit" th:disabled="${results.first}">Anterior</button>
        </form>

        <form method="post" th:action="@{/ui/employees/buscar}" class="m-0">
          <input type="hidden" name="empNo" th:value="${empNo}">
          <input type="hidden" name="birthDate" th:value="${birthDate}">
          <input type="hidden" name="firstName" th:value="${firstName}">
          <input type="hidden" name="lastName" th:value="${lastName}">
          <input type="hidden" name="gender" th:value="${gender}">
          <input type="hidden" name="hireDate" th:value="${hireDate}">
          <input type="hidden" name="deptNo" th:value="${deptNo}">
          <input type="hidden" name="fromDate" th:value="${fromDate}">
          <input type="hidden" name="toDate" th:value="${toDate}">
          <input type="hidden" name="size" th:value="${size}">
          <input type="hidden" name="page" th:value="${results.number + 1}">
          <button class="btn btn-outline-primary btn-sm" type="submit" th:disabled="${results.last}">Siguiente</button>
        </form>
      </div>
    </div>

    <table class="table table-sm table-striped align-middle">
      <thead class="table-light">
      <tr>
        <th>Emp No</th>
        <th>Nombre</th>
        <th>Apellido</th>
        <th>Género</th>
        <th>Nacimiento</th>
        <th>Contratación</th>
        <th>Depto</th>
        <th>From</th>
        <th>To</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="item : ${results.content}">
        <td th:text="${item.empNo}"></td>
        <td th:text="${item.firstName}"></td>
        <td th:text="${item.lastName}"></td>
        <td th:text="${item.gender}"></td>
        <td th:text="${item.birthDate}"></td>
        <td th:text="${item.hireDate}"></td>
        <td th:text="${item.deptNo}"></td>
        <td th:text="${item.fromDate}"></td>
        <td th:text="${item.toDate}"></td>
      </tr>
      </tbody>
    </table>
  </div>

</div>

</body>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js" integrity="sha384-G/EV+4j2dNv+tEPo3++6LCgdCROaejBqfUeNjuKAiuXbjrxilcCdDz6ZAVfHWe1Y" crossorigin="anonymous"></script>
</html>
